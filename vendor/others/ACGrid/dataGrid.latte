{* ====== FLASH MESSAGES ***********************}

{define flashes}
	<div n:snippet="flashes">
		<p class="alert alert-{$flash->type === 'error' ? 'danger' : $flash->type}" n:foreach="$flashes as $flash">
			{$flash->message}
		</p>
	</div>
{/define}

{* ====== LINE *********************************}

{snippet grid}

	{define line}
		<tr n:snippet="line-{$row->id}">
			{foreach $columns as $column}
				<td>
					{if $row->id === $id}
						{formContainer inner}
							{input $column->name, class => 'form-control'}
						{/formContainer}
					{else}
						{$row->{$column->name}}
					{/if}
				</td>
			{/foreach}
			<td n:if="$actions">
				{if $row->id === $id}
					{include #edit-form-buttons, labels => $labels}
				{else}
					{include #line-buttons, row => $row, cmd => $cmd, editable => $editable, removable => $removable,
					label => $labels}
				{/if}
			</td>
		</tr>
	{/define}

	{define edit-form-buttons}
		{input save}
		{input cancel}
	{/define}

	{define line-buttons}
		<a n:if="$editable" n:href="server! $cmd['EDIT'], $row->id" class="ajax">{$labels['edit']}</a>
		<a n:if="$removable" n:href="server! $cmd['REMOVE'], $row->id" class="ajax">{$labels['remove']}</a>
	{/define}


	<div class="container-fluid">
		{include flashes}

		{form editForm}
			<table class="table table-bordered table-striped">
				{snippet interior}
					<thead>
					<tr>
						{foreach $columns as $column}
							<th>{$column->label}</th>
						{/foreach}
						<th n:if="$actions">
							<a n:if="$adding" n:href="server! $cmd['ADD']" class="ajax">{$labels['new']}</a>
						</th>
					</tr>
					</thead>
					<tbody>
					{snippet rows}
						{foreach $data as $row}
							{include #line, row => $row, columns => $columns, id => $id, cmd => $cmd,
						editable => $editable, removable => $removable, actions => $actions, labels => $labels}
						{/foreach}
					{/snippet}
					</tbody>
					<tfoot>
					<td colspan="{count($columns) + ($actions ? 1 : 0)}">ACGrid</td>
					</tfoot>
				{/snippet}
			</table>
		{/form}
	</div>

{/snippet}